
<!DOCTYPE html>
<html lang="en" data-theme="system">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shift Start-Up Meeting</title>

  <!-- Optional font (falls back gracefully if offline) -->
  https://fonts.googleapis.com
  https://fonts.gstatic.com
  https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap

  <style>
    /* ---------- Design Tokens ---------- */
    :root {
      --brand: #2563eb;
      --brand-2: #7c3aed;
      --success: #059669;
      --danger: #dc2626;
      --ink: #0b1220;
      --ink-2: #1f2937;
      --muted: #6b7280;
      --bg: #0c1220; /* slightly darker base to pair with photos */
      --card: #ffffff;
      --border: #e8ecf2;
      --ring: rgba(37, 99, 235, 0.3);
      --glow: 0 10px 30px rgba(37, 99, 235, 0.15);
      --radius: 14px;

      /* Background image token (you can change this default URL or upload via UI) */
      --bg-image: url('https://images.unsplash.com/photo-1529070538774-1843cb3265df?q=80&w=1600&auto=format&fit=crop'); /* warehouse-like abstract */
      --bg-overlay: rgba(10, 14, 22, 0.45); /* legibility overlay */
    }

    /* Dark mode */
    @media (prefers-color-scheme: dark) {
      :root {
        --ink: #e5e7eb;
        --ink-2: #cbd5e1;
        --muted: #9ca3af;
        --card: #111827;
        --border: #1f2a3a;
        --ring: rgba(37, 99, 235, 0.45);
        --glow: 0 10px 30px rgba(37, 99, 235, 0.25);
      }
    }

    /* Manual theme toggle support */
    html[data-theme="light"] {
      --ink: #0b1220;
      --ink-2: #1f2937;
      --muted: #6b7280;
      --card: #ffffff;
      --border: #e8ecf2;
      --ring: rgba(37, 99, 235, 0.3);
      --glow: 0 10px 30px rgba(37, 99, 235, 0.15);
    }
    html[data-theme="dark"] {
      --ink: #e5e7eb;
      --ink-2: #cbd5e1;
      --muted: #9ca3af;
      --card: #111827;
      --border: #1f2a3a;
      --ring: rgba(37, 99, 235, 0.45);
      --glow: 0 10px 30px rgba(37, 99, 235, 0.25);
    }

    /* ---------- Global Reset ---------- */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }

    /* Full-screen background image + gradients + overlay */
    body {
      font-family: "Inter", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      /* Layer order: decorative gradients (top), photo (bottom) */
      background-image:
        radial-gradient(1200px 800px at -10% -10%, rgba(37, 99, 235, 0.10), transparent 50%),
        radial-gradient(900px 600px at 110% -10%, rgba(124, 58, 237, 0.10), transparent 50%),
        var(--bg-image);
      background-size:
        auto,
        auto,
        cover;
      background-position:
        left top,
        right top,
        center;
      background-repeat: no-repeat, no-repeat, no-repeat;
      background-attachment:
        fixed,
        fixed,
        fixed;
      color: var(--ink);
      line-height: 1.45;
      padding: 20px;
      position: relative;
      min-height: 100%;
    }
    /* Dark overlay for legibility on any image */
    body::after {
      content: "";
      position: fixed;
      inset: 0;
      background: var(--bg-overlay);
      pointer-events: none;
      z-index: 0;
    }

    /* Content sits above overlay */
    .container, .actions, .toasts { position: relative; z-index: 1; }

    .container { max-width: 1200px; margin: 0 auto; }

    /* ---------- Sticky Action Bar ---------- */
    .actions {
      position: sticky;
      top: 12px;
      z-index: 50;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      padding: 10px;
      backdrop-filter: blur(12px);
      border: 1px solid var(--border);
      border-radius: 999px;
      background: color-mix(in oklab, var(--card) 88%, transparent);
      box-shadow: var(--glow);
      margin: 18px 0 26px 0;
      justify-content: center;
    }
    .btn {
      --bg-btn: var(--brand);
      --bg-btn-hover: color-mix(in oklab, var(--brand) 82%, black 8%);
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 16px;
      border: 1px solid var(--border);
      border-radius: 999px;
      font-weight: 600;
      font-size: 14px;
      color: #fff;
      background: var(--bg-btn);
      box-shadow: 0 6px 18px rgba(17, 24, 39, 0.15);
      cursor: pointer;
      transition: transform .15s ease, box-shadow .15s ease, background .15s ease;
      user-select: none;
    }
    .btn:hover { transform: translateY(-1px); box-shadow: 0 10px 24px rgba(17, 24, 39, 0.2); background: var(--bg-btn-hover); }
    .btn:active { transform: translateY(0); }
    .btn--subtle {
      --bg-btn: color-mix(in oklab, var(--brand) 14%, var(--card));
      --bg-btn-hover: color-mix(in oklab, var(--brand) 20%, var(--card));
      color: var(--ink);
    }
    .btn--success { --bg-btn: var(--success); --bg-btn-hover: color-mix(in oklab, var(--success) 85%, black 8%); }
    .btn--danger  { --bg-btn: var(--danger);  --bg-btn-hover: color-mix(in oklab, var(--danger) 85%, black 8%); }
    .btn svg { width: 18px; height: 18px; }

    /* ---------- Header ---------- */
    .header {
      background: linear-gradient(135deg, color-mix(in oklab, var(--brand) 92%, #1b3b96 8%), color-mix(in oklab, var(--brand-2) 60%, #1c0f3d 40%));
      color: white;
      padding: 40px;
      text-align: center;
      border-radius: var(--radius) var(--radius) 0 0;
      box-shadow: 0 12px 32px rgba(0,0,0,0.18);
      position: relative;
      overflow: hidden;
      isolation: isolate;
    }
    .header::after {
      content: "";
      position: absolute;
      inset: -40%;
      background: radial-gradient(600px 300px at 70% -20%, rgba(255,255,255,0.25), transparent 60%);
      z-index: -1;
    }
    .header h1 {
      font-size: clamp(28px, 4vw, 44px);
      line-height: 1.1;
      margin-bottom: 18px;
      font-weight: 800;
      letter-spacing: 0.3px;
      text-shadow: 0 2px 14px rgba(0,0,0,0.2);
    }
    .header-info {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 18px;
      margin-top: 10px;
    }
    .header-info-box {
      background: rgba(255,255,255,0.14);
      padding: 16px;
      border-radius: 12px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.25);
      text-align: left;
    }
    .header-info-box label {
      display: block;
      font-size: 12px;
      margin-bottom: 6px;
      opacity: 0.9;
      font-weight: 600;
      letter-spacing: .3px;
    }
    .header-info-box input {
      width: 100%;
      padding: 12px 12px;
      font-size: clamp(16px, 2.2vw, 20px);
      font-weight: 700;
      border: none;
      border-radius: 8px;
      background: #fff;
      color: #111827;
    }

    /* ---------- KPI Cards ---------- */
    .kpis {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 14px;
      margin: 16px 0 6px;
    }
    .kpi {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 4px 14px rgba(0,0,0,0.06);
    }
    .kpi h3 {
      font-size: 12px;
      color: var(--muted);
      font-weight: 700;
      letter-spacing: .35px;
      margin-bottom: 6px;
      text-transform: uppercase;
    }
    .kpi .value {
      font-size: clamp(20px, 3vw, 28px);
      font-weight: 800;
      color: var(--ink);
    }
    .kpi .sub {
      font-size: 12px;
      color: var(--muted);
      margin-top: 6px;
    }

    /* ---------- Sections ---------- */
    .section {
      background: color-mix(in oklab, var(--card) 96%, transparent);
      padding: 28px;
      margin: 20px 0;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
      backdrop-filter: blur(4px);
    }
    .section h2 {
      font-size: clamp(18px, 2.6vw, 26px);
      margin-bottom: 18px;
      padding-bottom: 10px;
      border-bottom: 3px solid;
      letter-spacing: .2px;
    }
    .section.previous h2 { color: var(--brand);   border-color: color-mix(in oklab, var(--brand) 35%, var(--border)); }
    .section.incoming h2 { color: var(--success); border-color: color-mix(in oklab, var(--success) 35%, var(--border)); }
    .section.safety   h2 { color: var(--danger);  border-color: color-mix(in oklab, var(--danger) 35%, var(--border)); }

    .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
    .full-width { grid-column: span 2; }

    .field {
      background: color-mix(in oklab, var(--card) 86%, transparent);
      padding: 16px;
      border-radius: 10px;
      border: 1px solid var(--border);
      transition: border-color .2s ease, background .2s ease;
    }
    .field:hover { border-color: color-mix(in oklab, var(--brand) 35%, var(--border)); }
    .field label {
      display: block;
      font-weight: 700;
      color: var(--ink-2);
      margin-bottom: 8px;
      font-size: 13px;
    }
    .field input,
    .field textarea {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border: 1.5px solid var(--border);
      border-radius: 8px;
      color: var(--ink);
      background: var(--card);
      transition: box-shadow .15s ease, border-color .15s ease, background .2s ease;
    }
    .field input:focus,
    .field textarea:focus {
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 4px var(--ring);
    }
    .field textarea { resize: vertical; min-height: 100px; }

    .staffing-split { display: flex; gap: 10px; align-items: center; }
    .staffing-split input { flex: 1; }
    .staffing-split span { font-size: 18px; color: var(--muted); font-weight: 800; }

    /* ---------- Footer ---------- */
    .footer {
      text-align: center;
      margin-top: 26px;
      padding: 22px;
      background: color-mix(in oklab, var(--card) 96%, transparent);
      border-radius: 0 0 var(--radius) var(--radius);
      color: var(--muted);
      font-size: 14px;
      border: 1px solid var(--border);
      border-top: none;
      backdrop-filter: blur(4px);
    }
    .footer .sig {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 12px;
      margin-top: 10px;
    }

    /* ---------- Toasts ---------- */
    .toasts {
      position: fixed;
      right: 16px;
      bottom: 16px;
      display: grid;
      gap: 10px;
      z-index: 99999;
    }
    .toast {
      background: var(--card);
      color: var(--ink);
      border: 1px solid var(--border);
      border-left: 4px solid var(--brand);
      padding: 12px 14px;
      border-radius: 12px;
      box-shadow: 0 8px 22px rgba(0,0,0,0.15);
      display: flex;
      align-items: center;
      gap: 10px;
      min-width: 240px;
      animation: slideIn .2s ease-out;
      backdrop-filter: blur(4px);
    }
    .toast--success { border-left-color: var(--success); }
    .toast--danger  { border-left-color: var(--danger); }
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(6px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* ---------- Print ---------- */
    @media print {
      body {
        background: #fff !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
        padding: 0;
      }
      body::after { display: none !important; }
      .actions, .toasts { display: none !important; }
      .section { page-break-inside: avoid; border: 1.5px solid #000; box-shadow: none; backdrop-filter: none; background: #fff; }
      .header { color-adjust: exact; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .kpi { border: 1px solid #000; }
      .footer { border: 1px solid #000; border-top: none; background: #fff; }
    }

    /* ---------- Responsive ---------- */
    @media (max-width: 900px) {
      .header-info, .grid { grid-template-columns: 1fr; }
      .full-width { grid-column: 1 / -1; }
      .kpis { grid-template-columns: repeat(2, 1fr); }
      .actions { border-radius: 18px; }
    }
    @media (max-width: 480px) {
      .kpis { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="toasts" id="toasts" aria-live="polite" aria-atomic="true"></div>

  <div id="app" class="container" aria-describedby="shortcuts">
    <!-- Header -->
    <div class="header">
      <h1>SHIFT START‑UP MEETING</h1>

      <div class="kpis" id="kpis">
        <div class="kpi" aria-live="polite">
          <h3>Orders Ready to Load</h3>
          <div class="value" id="kpi-ready">—</div>
          <div class="sub">From previous + dock</div>
        </div>
        <div class="kpi" aria-live="polite">
          <h3>Orders Remaining</h3>
          <div class="value" id="kpi-remaining">—</div>
          <div class="sub">To pick this shift</div>
        </div>
        <div class="kpi" aria-live="polite">
          <h3>Inbound Waiting</h3>
          <div class="value" id="kpi-inbound">—</div>
          <div class="sub">Awaiting processing</div>
        </div>
        <div class="kpi" aria-live="polite">
          <h3>Coverage</h3>
          <div class="value" id="kpi-coverage">—</div>
          <div class="sub">Actual / Total</div>
        </div>
      </div>

      <div class="header-info">
        <div class="header-info-box">
          <label for="date">Date</label>
          <input type="date" id="date" />
        </div>
        <div class="header-info-box">
          <label for="outgoingShift">Outgoing Shift</label>
          <input type="text" id="outgoingShift" placeholder="e.g., B (Day)" />
        </div>
        <div class="header-info-box">
          <label for="incomingShift">Incoming Shift</label>
          <input type="text" id="incomingShift" placeholder="e.g., C (Night)" />
        </div>
      </div>
    </div>

    <!-- Sticky Actions -->
    <div class="actions">
      <button class="btn btn--success" id="btn-print" title="Print (Ctrl/Cmd + P)">
        <svg viewBox="0 0 24 24" fill="none"><path d="M6 9V4h12v5M6 14H5a2 2 0 0 1-2-2v-1a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v1a2 2 0 0 1-2 2h-1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        Print
      </button>
      <button class="btn" id="btn-download" title="Download full HTML">
        <svg viewBox="0 0 24 24" fill="none"><path d="M12 3v12m0 0 4-4m-4 4-4-4M5 21h14" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        Download HTML
      </button>
      <button class="btn" id="btn-save" title="Save data as JSON (Ctrl/Cmd + S)">
        <svg viewBox="0 0 24 24" fill="none"><path d="M4 7a2 2 0 0 1 2-2h9l5 5v9a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V7Z" stroke="#fff" stroke-width="2"/><path d="M13 4v6H6" stroke="#fff" stroke-width="2" stroke-linecap="round"/></svg>
        Save Data
      </button>
      <button class="btn btn--subtle" id="btn-load" title="Load a saved JSON file">
        <svg viewBox="0 0 24 24" fill="none"><path d="M12 3v12m0 0 4-4m-4 4-4-4M5 21h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        Load Data
      </button>
      <button class="btn btn--subtle" id="btn-theme" title="Toggle light/dark (Ctrl/Cmd + T)">
        <svg id="icon-theme" viewBox="0 0 24 24" fill="none"><path d="M12 3a9 9 0 0 0 0 18 9 9 0 0 1 0-18Z" stroke="currentColor" stroke-width="2"/></svg>
        Theme
      </button>
      <button class="btn btn--subtle" id="btn-bg" title="Set background image">
        <svg viewBox="0 0 24 24" fill="none"><path d="M4 5h16a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1Z" stroke="currentColor" stroke-width="2"/><path d="m8 13 2.5-3 3.5 4 2-2 3 4H5l3-3Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        Background
      </button>
      <button class="btn btn--danger" id="btn-bg-clear" title="Clear background image">
        <svg viewBox="0 0 24 24" fill="none"><path d="M3 6h18M8 6v12m8-12v12M5 6l1-3h12l1 3" stroke="#fff" stroke-width="2" stroke-linecap="round"/></svg>
        Clear BG
      </button>
      <button class="btn btn--danger" id="btn-reset" title="Clear all fields">
        <svg viewBox="0 0 24 24" fill="none"><path d="M3 6h18M8 6v12m8-12v12M5 6l1-3h12l1 3" stroke="#fff" stroke-width="2" stroke-linecap="round"/></svg>
        Reset
      </button>
      <input type="file" id="file-input" accept="application/json" hidden />
      <input type="file" id="bg-input" accept="image/*" hidden />
    </div>

    <!-- Previous Shift -->
    <div class="section previous">
      <h2>PREVIOUS SHIFT</h2>
      <div class="grid">
        <div class="field">
          <label for="ordersPicked">Orders Picked</label>
          <input type="number" id="ordersPicked" min="0" step="1" inputmode="numeric" />
        </div>
        <div class="field">
          <label for="schedulePickupTime">Scheduled Pickup Time</label>
          <input type="time" id="schedulePickupTime" />
        </div>
        <div class="field">
          <label for="ordersLoaded">Orders Loaded</label>
          <input type="number" id="ordersLoaded" min="0" step="1" inputmode="numeric" />
        </div>
        <div class="field">
          <label for="scheduleLoadTime">Scheduled Load Time</label>
          <input type="time" id="scheduleLoadTime" />
        </div>
        <div class="field">
          <label for="inboundDone">Inbound Orders Done</label>
          <input type="number" id="inboundDone" min="0" step="1" inputmode="numeric" />
        </div>
        <div class="field">
          <label>Staffing (Actual / Total)</label>
          <div class="staffing-split">
            <input type="number" id="actualOnShift" placeholder="Actual" min="0" step="1" inputmode="numeric" />
            <span>/</span>
            <input type="number" id="totalTeamMembers" placeholder="Total" min="0" step="1" inputmode="numeric" />
          </div>
        </div>
      </div>
    </div>

    <!-- Incoming Shift -->
    <div class="section incoming">
      <h2>INCOMING SHIFT</h2>
      <div class="grid">
        <div class="field full-width">
          <label for="xdocItems">XDOC Item Numbers for Shift</label>
          <input type="text" id="xdocItems" placeholder="e.g., 10543, 10587, 10612" />
        </div>
        <div class="field">
          <label for="ordersLeftToPick">Orders Left to Pick</label>
          <input type="number" id="ordersLeftToPick" min="0" step="1" inputmode="numeric" />
        </div>
        <div class="field">
          <label for="pickupTimeRemaining">Scheduled Pickup Time</label>
          <input type="time" id="pickupTimeRemaining" />
        </div>
        <div class="field">
          <label for="ordersInDock">Orders in Dock Ready to Load</label>
          <input type="number" id="ordersInDock" min="0" step="1" inputmode="numeric" />
        </div>
        <div class="field">
          <label for="scheduleLoadTimeIncoming">Scheduled Load Time</label>
          <input type="time" id="scheduleLoadTimeIncoming" />
        </div>
        <div class="field">
          <label for="inboundWaiting">Inbound Orders Waiting</label>
          <input type="number" id="inboundWaiting" min="0" step="1" inputmode="numeric" />
        </div>
        <div class="field">
          <label>Staffing (Actual / Total)</label>
          <div class="staffing-split">
            <input type="number" id="actualOnShiftIncoming" placeholder="Actual" min="0" step="1" inputmode="numeric" />
            <span>/</span>
            <input type="number" id="totalTeamMembersIncoming" placeholder="Total" min="0" step="1" inputmode="numeric" />
          </div>
        </div>
      </div>
    </div>

    <!-- Safety -->
    <div class="section safety">
      <h2>SAFETY</h2>
      <div class="grid">
        <div class="field full-width">
          <label for="concerns">Safety Concerns</label>
          <textarea id="concerns" placeholder="List any safety concerns or incidents..."></textarea>
        </div>
        <div class="field full-width">
          <label for="quickTopic">Quick Safety Topic to Cover</label>
          <textarea id="quickTopic" placeholder="Brief safety reminder or topic for incoming shift..."></textarea>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      <div class="sig">
        <div class="field">
          <label for="completedBy">Completed by</label>
          <input type="text" id="completedBy" placeholder="Name" />
        </div>
        <div class="field">
          <label for="completedTime">Time</label>
          <input type="time" id="completedTime" />
        </div>
      </div>
      <p id="shortcuts" style="margin-top:10px; color:var(--muted);">
        Shortcuts: Ctrl/Cmd+S Save • Ctrl/Cmd+P Print • Ctrl/Cmd+T Theme
      </p>
    </div>
  </div>

  <script>
    // ------------------ Utilities ------------------
    const $ = (sel, root = document) => root.querySelector(sel);
    const $$ = (sel, root = document) => [...root.querySelectorAll(sel)];
    const toasts = $('#toasts');

    const toast = (msg, level = "success") => {
      const div = document.createElement('div');
      div.className = `toast toast--${level}`;
      div.innerHTML = `
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
          ${level === 'danger'
            ? '<path d="M12 9v4m0 4h.01M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>'
            : '<path d="M20 6 9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>'}
        </svg>
        <span>${msg}</span>
      `;
      toasts.appendChild(div);
      setTimeout(() => {
        div.style.transition = 'opacity .2s ease, transform .2s ease';
        div.style.opacity = '0';
        div.style.transform = 'translateY(4px)';
        setTimeout(() => div.remove(), 220);
      }, 2200);
    };

    const debounce = (fn, delay = 250) => {
      let t;
      return (...args) => {
        clearTimeout(t);
        t = setTimeout(() => fn(...args), delay);
      };
    };

    const getNum = (v) => {
      const n = parseFloat(String(v).replace(/,/g, '').trim());
      return Number.isFinite(n) ? n : 0;
    };

    // ------------------ Fields & Persistence ------------------
    const fields = [
      'date','outgoingShift','incomingShift',
      'ordersPicked','schedulePickupTime','ordersLoaded','scheduleLoadTime','inboundDone','actualOnShift','totalTeamMembers',
      'xdocItems','ordersLeftToPick','pickupTimeRemaining','ordersInDock','scheduleLoadTimeIncoming','inboundWaiting','actualOnShiftIncoming','totalTeamMembersIncoming',
      'concerns','quickTopic',
      'completedBy','completedTime'
    ];

    const todayISO = new Date().toISOString().slice(0,10);

    window.addEventListener('load', () => {
      fields.forEach(id => {
        const el = document.getElementById(id);
        const saved = localStorage.getItem(id);
        if (saved !== null && el) {
          el.value = saved;
        }
      });
      const dateEl = $('#date');
      if (dateEl && !dateEl.value) dateEl.value = todayISO;

      // Restore background image if set
      const savedBg = localStorage.getItem('bgImage');
      if (savedBg) {
        document.documentElement.style.setProperty('--bg-image', `url(${savedBg})`);
      }

      renderKPIs();
    });

    // Auto-save with debounce and KPI re-calc
    fields.forEach(id => {
      const el = document.getElementById(id);
      if (!el) return;
      const onChange = debounce(() => {
        localStorage.setItem(id, el.value);
        renderKPIs();
      }, 180);
      el.addEventListener('input', onChange);
      el.addEventListener('change', onChange);
    });

    // ------------------ KPIs ------------------
    function renderKPIs() {
      const ready = getNum($('#ordersLoaded')?.value) + getNum($('#ordersInDock')?.value);
      const remaining = getNum($('#ordersLeftToPick')?.value);
      const inbound = getNum($('#inboundWaiting')?.value);
      const a = getNum($('#actualOnShiftIncoming')?.value) || getNum($('#actualOnShift')?.value);
      const t = getNum($('#totalTeamMembersIncoming')?.value) || getNum($('#totalTeamMembers')?.value);

      $('#kpi-ready').textContent = Number.isFinite(ready) && ready >= 0 ? ready.toLocaleString() : '—';
      $('#kpi-remaining').textContent = Number.isFinite(remaining) && remaining >= 0 ? remaining.toLocaleString() : '—';
